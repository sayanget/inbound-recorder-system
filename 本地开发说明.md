# 本地开发说明

## ✅ 问题已解决

之前遇到的 `psycopg2-binary` 安装错误已经解决。

## 解决方案

我们将依赖分为两个文件:

### 1. `requirements.txt` (本地开发)
只包含核心依赖,**不包含 PostgreSQL**:
- Flask
- openpyxl
- pytz
- schedule
- python-dotenv

### 2. `requirements-prod.txt` (生产部署)
包含所有依赖,**包括 PostgreSQL**:
- 所有核心依赖
- psycopg2-binary (PostgreSQL 驱动)
- gunicorn (生产服务器)
- Flask-Session

## 本地启动

### 方式 1: 直接运行 (推荐)

```bash
# 无需安装任何额外依赖
python single_app.py
```

### 方式 2: 使用批处理文件

```bash
一键启动.bat
```

### 方式 3: 重新安装依赖 (如果之前安装失败)

```bash
# 只安装本地开发需要的依赖
pip install -r requirements.txt
```

## 工作原理

`database.py` 会自动检测:

1. **没有 `DATABASE_URL` 环境变量** → 使用 SQLite (本地模式)
2. **有 `DATABASE_URL` 但 psycopg2 未安装** → 自动回退到 SQLite
3. **有 `DATABASE_URL` 且 psycopg2 已安装** → 使用 PostgreSQL

## 测试结果

```
[数据库] 使用 SQLite (本地模式) ✅
```

## Zeabur 部署

Zeabur 部署时会使用 `requirements-prod.txt`,自动安装 PostgreSQL 驱动。

详见: [`ZEABUR_QUICK_START.md`](file:///d:/project/inbound_python_source/ZEABUR_QUICK_START.md)
